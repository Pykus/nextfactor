<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Wybierz listę</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container py-4">
    <h2 class="mb-4">📋 Wybierz istniejącą listę</h2>

    {% if existing_lists %}
        <div class="d-flex flex-wrap gap-2 mb-4">
            {% for entry in existing_lists %}
                <form 
                method="POST" 
                hx-post="{% url 'set_list' %}" 
                hx-swap="none" 
                hx-on::after-request="location.reload()"
                style="display: inline"
            >
                {% csrf_token %}
                <input type="hidden" name="list_name" value="{{ entry.list_name }}">
                <button class="btn btn-outline-primary btn-sm" type="submit">
                    {{ entry.list_name }} ({{ entry.item_count }})
                </button>
                </form>
            {% endfor %}
        </div>
    {% else %}
        <p class="text-muted">Brak zdefiniowanych list – dodaj nową.</p>
    {% endif %}

    <hr class="my-4">

    <h4 class="mb-3">➕ Lub utwórz nową listę</h4>

    <form 
        method="POST"
        hx-post="{% url 'set_list' %}"
        hx-swap="none"
        hx-target="this"
        hx-on::after-request="location.reload()"
    >
        {% csrf_token %}
        <input 
            type="text" 
            name="list_name" 
            class="form-control mb-3" 
            placeholder="np. kasienkaiprzemyslaw"
            required
        >
        <button class="btn btn-success w-100">Utwórz i przejdź</button>
    </form>

    <p class="mt-4 text-center">
        <a href="#" hx-get="{% url 'inbox_entry_point' %}" hx-target="body" hx-swap="outerHTML">
            ← Anuluj i wróć
        </a>
    </p>
</body>
</html>
